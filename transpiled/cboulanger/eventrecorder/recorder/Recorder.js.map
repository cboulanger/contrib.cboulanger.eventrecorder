{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/eventrecorder/source/class/cboulanger/eventrecorder/recorder/Recorder.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "include",
    "cboulanger",
    "eventrecorder",
    "MHelperMethods",
    "MState",
    "construct",
    "__excludeIds",
    "__lines",
    "addGlobalEventListener",
    "target",
    "event",
    "isRunning",
    "id",
    "getAttribute",
    "Id",
    "getAbsoluteIdOf",
    "recordEvent",
    "properties",
    "mode",
    "check",
    "nullable",
    "init",
    "logEvents",
    "members",
    "__lastEventTimestamp",
    "__latInput",
    "excludeIds",
    "ids",
    "lang",
    "Type",
    "isArray",
    "found",
    "excluded",
    "substr",
    "length",
    "debug",
    "push",
    "getExcludedIds",
    "getObjectIds",
    "traverseObjectTree",
    "obj",
    "getQxObjectId",
    "e",
    "error",
    "owned",
    "getOwnedQxObjects",
    "registeredObjects",
    "getInstance",
    "getRegisteredObjects",
    "values",
    "message",
    "getScript",
    "join",
    "setScript",
    "script",
    "Assert",
    "assertString",
    "split",
    "beforeStart",
    "getMode",
    "document",
    "location",
    "host",
    "pathname",
    "concat",
    "Date",
    "toLocaleString",
    "getTrackEvents",
    "delay",
    "_createDelay",
    "lines",
    "_eventToCode",
    "afterStop",
    "type",
    "getType",
    "data",
    "getData",
    "owner",
    "getQxOwner",
    "getLogEvents",
    "JSON",
    "stringify",
    "toString",
    "ui",
    "form",
    "DateField",
    "ComboBox",
    "VirtualComboBox",
    "tree",
    "FolderOpenButton",
    "FocusHandler",
    "isFocusRoot",
    "getQxObject",
    "__lastInput",
    "isModelSelection",
    "Array",
    "getModel",
    "ownerId",
    "model",
    "indexes",
    "toArray",
    "map",
    "item",
    "indexOf",
    "isString",
    "VirtualTree",
    "row",
    "getLookupTable",
    "nodeId",
    "treevirtual",
    "TreeVirtual",
    "selection",
    "getDataModel",
    "getRowFromNodeId",
    "virtual",
    "Row",
    "table",
    "Model",
    "ranges",
    "getSelectedRanges",
    "minIndex",
    "maxIndex",
    "selected",
    "selectedId",
    "getSelectables",
    "index",
    "startsWith",
    "getTrackPropertyChanges",
    "property",
    "String",
    "firstLow",
    "now",
    "msSinceLastEvent",
    "recorder",
    "Recorder"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n  UI Event Recorder\n\n  Copyright:\n    2018 Christian Boulanger\n\n  License:\n    MIT license\n    See the LICENSE file in the project's top-level directory for details.\n\n  Authors: Christian Boulanger\n\n************************************************************************ */\n\n/**\n * The base class of all recorder types\n * @require(qx.bom.Element)\n */\nqx.Class.define(\"cboulanger.eventrecorder.recorder.Recorder\", {\n  extend : qx.core.Object,\n  include : [\n    cboulanger.eventrecorder.MHelperMethods,\n    cboulanger.eventrecorder.MState\n  ],\n\n  /**\n   * Constructor\n   */\n  construct : function() {\n    this.base(arguments);\n\n    this.__excludeIds = [];\n    this.__lines = [];\n\n    this.addGlobalEventListener((target, event) => {\n      if (!this.isRunning()) {\n        return;\n      }\n      let id;\n      if (typeof target.getAttribute == \"function\") {\n        id = target.getAttribute(\"data-qx-object-id\");\n      } else if (target instanceof qx.core.Object) {\n        id = qx.core.Id.getAbsoluteIdOf(target, true);\n      } else {\n        return;\n      }\n      if (id) {\n        this.recordEvent(id, event, target);\n      }\n    });\n  },\n\n  properties: {\n\n    /**\n     * The recorder mode, can be \"overwrite\" or \"append\"\n     */\n    mode: {\n      check: [\"overwrite\", \"append\"],\n      nullable: false,\n      init: \"overwrite\"\n    },\n\n    /**\n     * Whether to output additional event data to the console\n     */\n    logEvents: {\n      check: \"Boolean\",\n      nullable: false,\n      init: false\n    }\n  },\n\n  /**\n   * The methods and simple properties of this class\n   */\n  members :\n  {\n    __lines: null,\n    __excludeIds: null,\n    __lastEventTimestamp: null,\n    __latInput: null,\n\n    /**\n     * Exclude the given id(s) from recording\n     * @param ids {Array|String}\n     */\n    excludeIds(ids) {\n      // normalize to array\n      ids = qx.lang.Type.isArray(ids)? ids: [ids];\n      // add ids that are not yet included by path\n      for (let id of ids) {\n        let found=false;\n        for (let excluded of this.__excludeIds) {\n          if (id.substr(0, excluded.length) === excluded) {\n            found = true;\n          }\n        }\n        if (!found) {\n          this.debug(`Excluding ${id} from event recording.`);\n          this.__excludeIds.push(id);\n        }\n      }\n    },\n\n    /**\n     * Returns the list of excluded ids.\n     * @return {String[]}\n     */\n    getExcludedIds() {\n      return this.__excludeIds;\n    },\n\n    /**\n     * Return an array of object ids that have been assigned in the current application\n     * @return {[]}\n     */\n    getObjectIds() {\n      let ids = [];\n      let traverseObjectTree = function (obj) {\n        if (typeof obj.getQxObjectId !== \"function\") {\n          return;\n        }\n        let id = obj.getQxObjectId();\n        if (id) {\n          try {\n            ids.push(qx.core.Id.getAbsoluteIdOf(obj));\n          } catch (e) {\n            this.error(`Cannot get absolute ID for object with id ${id}.`);\n          }\n        }\n        for (let owned of obj.getOwnedQxObjects()) {\n          traverseObjectTree(owned);\n        }\n      };\n      try {\n        let registeredObjects = qx.core.Id.getInstance().getRegisteredObjects() || {};\n        for (let obj of Object.values(registeredObjects)) {\n          traverseObjectTree(obj);\n        }\n        return ids;\n      } catch (e) {\n        this.error(e.message);\n        return [];\n      }\n    },\n\n    /**\n     * Returns the recorded script\n     * @return {String}\n     */\n    getScript() {\n      return this.__lines.join(\"\\n\");\n    },\n\n    /**\n     * Sets the script to which the recorder should append new events\n     * @param script {String}\n     */\n    setScript(script) {\n      if (script) {\n        qx.core.Assert.assertString(script);\n        this.__lines = script.split(/\\n/);\n      } else {\n        this.__lines = [];\n      }\n    },\n\n    /**\n     * Called by start()\n     */\n    beforeStart() {\n      switch (this.getMode()) {\n        case \"overwrite\":\n          this.__lines = [\n            `config-set-mode presentation`,\n            `assert-match-uri ${document.location.host + document.location.pathname}`,\n            \"\"\n          ];\n          break;\n        case \"append\":\n          this.__lines = this.__lines.concat([\n            \"\",\n            `# appended at ${(new Date()).toLocaleString()}`,\n            \"\"\n          ]);\n          break;\n      }\n      this.__lastEventTimestamp = 0;\n    },\n\n    /**\n     * Called by the global event listener\n     * @param id {String}\n     * @param event {qx.event.type.Event}\n     * @param target {qx.bom.Element}\n     * @private\n     * @return {boolean} returns true if the event was recorded, false if\n     * it was ignored because of the list of excluded ids or an opt-out.\n     */\n    recordEvent(id, event, target) {\n      for (let excluded of this.__excludeIds) {\n        if (id.substr(0, excluded.length) === excluded) {\n          return false;\n        }\n      }\n      // opt out of recording\n      if (typeof target.getTrackEvents === \"function\" && !target.getTrackEvents()) {\n        return false;\n      }\n      let delay = this._createDelay();\n      let lines = this._eventToCode(id, event, target);\n      if (lines.length) {\n        this.__lines = this.__lines.concat(delay).concat(lines);\n      }\n      return true;\n    },\n\n    /**\n     * Executed after stop()\n     */\n    afterStop() {\n      this.__lastEventTimestamp = 0;\n    },\n\n    /**\n     * Given an object id, the event name and the even target, return one or more\n     * pieces of intermediate code from which a player can replay the user action\n     * that lead to this event. Return an array, each element is one line of code.\n     * This method can be overridden by subclasses. The overriding method should\n     * check the event, and if it decide to not handle it, return the result from the\n     * call to this method.\n     * @param id {String} The id of the qooxdoo object\n     * @param event {qx.event.Event} The event that was fired\n     * @param target {qx.bom.Element|qx.core.Object} The event target\n     * @return {String[]} An array of script lines\n     */\n    _eventToCode(id, event, target) {\n      let lines = [];\n      const type = event.getType();\n      let data = typeof event.getData == \"function\" ? event.getData() : null;\n      let owner = typeof target.getQxOwner == \"function\" ? target.getQxOwner() : null;\n      if (this.getLogEvents()) {\n        this.debug(JSON.stringify({id, owner: owner && owner.toString(), type: type, data:data, target:target.toString()}));\n      }\n      switch (type) {\n        case \"dbltap\":\n          return [`dbltap ${id}`];\n        case \"contextmenu\":\n          lines.push(`assert-appeared ${id}`);\n          lines.push(`contextmenu ${id}`);\n          return lines;\n        case \"tap\":\n          return [`tap ${id}`];\n        case \"execute\":\n          switch (true) {\n            case owner instanceof qx.ui.form.DateField:\n            case owner instanceof qx.ui.form.ComboBox:\n            case owner instanceof qx.ui.form.VirtualComboBox:\n            case target instanceof qx.ui.tree.core.FolderOpenButton:\n              return [];\n          }\n          lines.push(`assert-appeared ${id}`);\n          lines.push(`execute ${id}`);\n          break;\n        case \"appear\":\n        case \"disappear\":\n          if (qx.ui.core.FocusHandler.getInstance().isFocusRoot(qx.core.Id.getQxObject(id))) {\n            return [`assert-${type}ed ${id}`];\n          }\n          return [];\n\n        case \"input\":\n          this.__lastInput = data;\n          return [];\n\n        case \"change\": {\n          // model selection\n          const isModelSelection =\n            target instanceof qx.data.Array &&\n            target.getQxOwner() &&\n            typeof target.getQxOwner().getModel == \"function\";\n          if (isModelSelection) {\n            const owner = target.getQxOwner();\n            const ownerId = qx.core.Id.getAbsoluteIdOf(owner);\n            const model = owner.getModel();\n            const indexes = target.toArray().map(item => model.indexOf(item));\n            lines.push(`set-model-selection ${ownerId} ${JSON.stringify(indexes)}`);\n            break;\n          }\n          // form fields\n          if (qx.lang.Type.isString(data) && data === this.__lastInput) {\n            lines.push(`set-value ${id} \"${data}\"`);\n          }\n          break;\n        }\n\n        case \"open\":\n        case \"close\": {\n          if (target instanceof qx.ui.tree.VirtualTree) {\n            let row = target.getLookupTable().indexOf(data);\n            if (row < 0) {\n              return [];\n            }\n            lines.push(`${type}-tree-node ${id} ${row}`);\n          }\n          break;\n        }\n        // qx.ui.treevirtual.TreeVirtual\n        case \"treeClose\":\n        case \"treeOpenWithContent\":\n        case \"treeOpenWhileEmpty\":\n          lines.push(`${type===\"treeClose\"?\"close-tree-node-treevirtual\":\"open-tree-node-treevirtual\"} ${id} ${data.nodeId}`);\n          break;\n\n        case \"changeSelection\": {\n          if (target instanceof qx.ui.treevirtual.TreeVirtual) {\n            let selection = event.getData();\n            if (!selection.length) {\n              return [];\n            }\n            let row = target.getDataModel().getRowFromNodeId(selection[0].nodeId);\n            lines.push(`set-table-selection ${id} ${row},${row}`);\n          }\n          if (target instanceof qx.ui.virtual.selection.Row) {\n            lines.push(`set-row-selection ${id} ${data}`);\n            break;\n          }\n          if (target instanceof qx.ui.table.selection.Model) {\n            lines.push(`reset-selection ${id}`);\n            let ranges = target.getSelectedRanges();\n            if (ranges.length) {\n              lines.push(`set-table-selection ${id} ${ranges[0].minIndex},${ranges[0].maxIndex}`);\n            }\n            break;\n          }\n          if (data && data.length && qx.lang.Type.isArray(data)) {\n            let selected = data[0];\n            if (selected instanceof qx.core.Object && selected.getQxObjectId()) {\n              let selectedId = qx.core.Id.getAbsoluteIdOf(selected);\n              lines.push(`set-selection ${id} ${selectedId}`);\n            } else if (typeof target.getSelectables == \"function\") {\n              let index = target.getSelectables().indexOf(selected);\n              lines.push(`set-selection-from-selectables ${id} ${index}`);\n            }\n            break;\n          }\n          return [];\n        }\n        default:\n          // record change events if explicitly requested\n          if (type.startsWith(\"change\") && typeof target.getTrackPropertyChanges == \"function\") {\n            if (target.getTrackPropertyChanges()) {\n              let property = qx.lang.String.firstLow(type.substr(6));\n              lines.push(`await-match-json ${id} ${property} ${JSON.stringify(data)}`);\n              break;\n            }\n          }\n          // ignore all others\n          return [];\n      }\n      return lines;\n    },\n\n    /**\n     * Returns an array, containing a \"delay\" command to replay delays in user action\n     * @return {String[]}\n     * @private\n     */\n    _createDelay() {\n      let now = Date.now();\n      let msSinceLastEvent = now - (this.__lastEventTimestamp || now);\n      this.__lastEventTimestamp = now;\n      if (msSinceLastEvent) {\n        return [`delay ${msSinceLastEvent}`];\n      }\n      return [];\n    }\n  }\n});\n"
  ]
}